## Решение

**I.** **Клиент**

Распаковываем клиента. Там куча файлов от Qt. Нам нужен только бинарь `letoctf2025.exe`.

В `Detect it easy` видим, что это обычный PE64 с использованием Qt. 
![image](https://github.com/user-attachments/assets/27157338-cb9a-4e46-bd35-618b95e8d3b6)


Открываем в любимом декомпиляторе. Я открою в `Ida Pro`. Ida сразу перекидывает нас в функцию `main()`. ![image](https://github.com/user-attachments/assets/d515957b-3f49-4618-8646-a351a21151f8)
 Из интересного только функция `createMainWindow()`, которая создаёт окно. Переходим в неё. Видим, как в ней создаются поля для ввода, кнопка, само окно. 

Нам интересно проследить за тем, что происходит при нажатии кнопки. Для этого ищем код, который выполняется при нажатии кнопки. Путём внимательного анализа понимаем, что вот нужная функция (сравните с исходником). ![image](https://github.com/user-attachments/assets/28a7fe04-b1cf-43d5-b460-922304d8a1e8)
. 
Из неё путём нескольких переходов попадаем в функцию `createMainWindow_::_2_::_lambda_1_::operator()`, которая создаёт сокет и отправляет на сервер `89.232.167.21:54321` введёные данные. С клиентом пока что закончили.

**II.** **Сервер**

Распаковав [сервер](public/server.rar), видим 3 файла. Очевидно, что нужно начать с бинаря server_p. Видим, что это ELF64, запакованный стандартным UPX. ![image](https://github.com/user-attachments/assets/c8fb9809-a078-4846-9fd0-32df9a512dd3)
 Распаковываем командой `upx -d server_p`. Видим, что бинарь на C++ использует Qt. ![alt text](image-4.png) Снова открываем в Ida Pro.

Нужную функцию проще всего найти по строкам, которые отправляются клиенту. Например, Incorrect. После нахождения, попадаем в огромную функцию, которая сначала проверяет логин и пароль с помощью eBPF (`filter.o`), затем проверяет лицензионный ключ с помощью бинаря `check_lic`.

Начнём с `filter.o`. ![image](https://github.com/user-attachments/assets/83b41095-7a69-43a0-9429-8664c7a85340)
 Так как Ida не умеет декомпилить bpf, воспользуемся Ghidra. В нём видим функцию `check_login(void)`, которая для каждого символа логина и пароля выполняет: вычитает 0x10 и ксорит с 0x55, затем сравнивает с идеалом. На основе значений получаем правильные логин и пароль.

Логин - `TralaleroTralala`
Пароль - `BalerinaCapucina`

Далее смотрим бинарь `check_lic`. Всё происходящее в нём проще посмотреть в [исходнике](src/check_lic.c).

Лицензионный ключ - `maMMma_m1A_the_pasta_1s_f1gHt1ng`

Если введённые значения правильные, сервер отправляет флаг клиенту.

## Флаг

`letoctf{maMMa_m1A_cHe_f1agOtTo}`

